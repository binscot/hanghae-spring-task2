<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <!-- Webpage Title -->
  <title>주특기 1주차 개인과제</title>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@500&display=swap" rel="stylesheet">
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bulma CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">
  <!-- Font Awesome CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

  <!-- JS -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>


  <title>Title</title>
  <style>
    .edit{
      width: 500px;
      margin: 100px auto;
    }
    .buttona{
      float: left;
      width: 200px;
    }
    .buttonb{
      float: right;
      width: 200px;
    }
    .buttons{
      margin-top: 10px;
    }
    .inputa{
      float: left;
      width: 150px;
    }
    .inputb{
      float: right;
      width: 300px;
    }
  </style>
  <script>
    //수정한 게시글이 올바른지 확인
    function isValidContents(contents) {
      if (contents == '') {
        alert('내용을 입력해주세요');
        return false;
      }

      if (contents.trim().length > 300) {
        alert('공백 포함 300자 이하로 입력해주세요');
        return false;
      }
      return true;
    }

    // 게시글 수정.
    function submitEdit(idx) {
      //작성 대상 메모의 username과 title, contents 를 확인합니다.
      let title = $(`#titlearea`).val().trim();
      let contents = $(`#textarea`).val().trim();



      //작성한 메모가 올바른지 isValidContents 함수를 통해 확인합니다.
      if (isValidContents(contents) == false) {
        return;
      }

      //전달할 data JSON으로 만듭니다.
      let data = {'title':title,'contents': contents};
      //넘겨줄 값을 id에 넣기
      let id = [[${id}]];
      //PUT /api/memos/{id} 에 data를 전달합니다.
      $.ajax({
        type: "PUT",
        url: `/api/articles/${id}`,
        contentType: "application/json",
        data: JSON.stringify(data),
        success: function (response) {
          alert('메시지 변경에 성공하였습니다.');
          window.location.assign('/')
        }
      });
    }
  </script>
</head>
<body>
<!--수정 박스-->
<div class="edit">
  <div class="control has-icons-left has-icons-right box">
    <h1 class="inputa">[[${username}]]</h1>
    <input class="input inputb" type="text" placeholder="제목" id="titlearea" th:value="${title}">
  </div>
  <div class="box">
    <textarea class="textarea" placeholder="내용을 입력하세요!" id="textarea" >[[${contents}]]</textarea>
    <div class="buttons">
      <button class="button buttona" onclick="history.back()">취소</button><button class="button buttonb" onclick="submitEdit()">작성 완료!</button>
    </div>
  </div>
</div>

</body>
</html>